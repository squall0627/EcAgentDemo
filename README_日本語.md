# EcAgentDemo - 使用ガイド

## 📖 はじめに

EcAgentDemoは、AI機能を搭載したEC商品管理システムです。このガイドでは、技術的な知識がない方でも簡単に使用できるよう、分かりやすく説明します。

## 🎯 このソフトウェアでできること

- **商品管理**: 商品の登録、編集、削除
- **注文管理**: 注文の確認、ステータス更新
- **AI対話**: ChatGPTなどのAIと会話しながら業務を効率化
- **音声入力**: マイクを使って音声でAIと会話
- **画像認識**: 写真をアップロードしてAIに画像の内容を質問
- **テストデータ自動導入**: 初回起動時に自動でサンプルデータを作成
- **データ表示・管理**: 商品や注文データを表形式で確認・編集
- **設定管理**: APIキーやシステム設定の変更

## 💻 必要な環境

- **Windows**: Windows 10以降
- **Mac**: macOS 10.15以降  
- **Linux**: Ubuntu 18.04以降
- **メモリ**: 4GB以上推奨
- **ディスク容量**: 500MB以上の空き容量

## 📦 インストール手順

### ステップ1: ファイルのダウンロード

1. 配布されたZIPファイルをダウンロードします
2. 任意の場所（例：デスクトップ）に解凍します

解凍後のフォルダ構成：
```
EcAgentDemo/
├── EcAgentDemo/        # 実行ファイルフォルダ
│   ├── EcAgentDemo.exe # メインプログラム（Windows版の場合）
│   ├── EcAgentDemo     # メインプログラム（Mac/Linux版の場合）
│   └── _internal/      # 内部ライブラリ
├── 起動スクリプト.bat   # Windows用起動スクリプト
├── 起動スクリプト.sh    # Mac/Linux用起動スクリプト
├── .env                # 設定ファイル
├── app.db              # インメモリSQLiteデータベース
└── README_日本語.md     # このファイル
```

**⚠️ 重要：プラットフォーム固有の実行ファイルについて**

PyInstallerの仕様により、実行ファイルは**ビルドされた環境でのみ動作**します：

- **Windows環境でビルド** → `EcAgentDemo.exe` が作成される（Windows専用）
- **macOS環境でビルド** → `EcAgentDemo`（拡張子なし）が作成される（macOS/Linux用）
- **Linux環境でビルド** → `EcAgentDemo`（拡張子なし）が作成される（Linux用）

**現在のZIPファイルに含まれる実行ファイル形式を確認するには：**
```bash
python verify_zip_contents.py
```

### ステップ2: プログラムの起動

**推奨方法：起動スクリプトを使用**

#### Windows の場合
1. `起動スクリプト.bat` をダブルクリック
2. Windowsセキュリティの警告が表示された場合は「詳細情報」→「実行」をクリック

#### Mac の場合
1. ターミナルを開く
2. プログラムのあるフォルダに移動
3. `./起動スクリプト.sh` を実行

#### Linux の場合
1. ターミナルを開く
2. プログラムのあるフォルダに移動
3. `./起動スクリプト.sh` を実行

**直接実行する場合（上級者向け）**

#### Windows の場合
1. `EcAgentDemo\EcAgentDemo.exe` をダブルクリック

#### Mac/Linux の場合
1. ターミナルで `./EcAgentDemo/EcAgentDemo` を実行

### ステップ3: ブラウザでアクセス

1. プログラムが起動したら、ブラウザを開きます
2. アドレスバーに `http://localhost:8000` と入力
3. Enterキーを押してアクセス

## ⚙️ 初期設定

### AIサービスの設定（オプション）

プログラムは設定なしでも動作しますが、より高性能なAI機能を使用するには以下の設定が必要です：

1. ブラウザで `http://localhost:8000` にアクセス
2. 画面右上の「設定」ボタンをクリック
3. 必要に応じて以下のAPIキーを入力：

#### OpenAI（ChatGPT）を使用する場合
- **OpenAI APIキー**: ChatGPT-4やGPT-3.5を使用
- 取得方法: https://platform.openai.com/api-keys

#### Anthropic（Claude）を使用する場合  
- **Anthropic APIキー**: Claude AIを使用
- 取得方法: https://console.anthropic.com/

#### Google（Gemini）を使用する場合
- **Google APIキー**: Gemini AIを使用
- 取得方法: https://makersuite.google.com/app/apikey

4. 設定を入力したら「保存」ボタンをクリック

### ポート番号の変更（必要に応じて）

デフォルトでは8000番ポートを使用しますが、他のソフトウェアと競合する場合は変更できます：

1. 設定ページで「API_BASE_URL」を見つける
2. `http://localhost:8000` の `8000` を別の番号に変更（例：`8080`）
3. 保存後、プログラムを再起動
4. ブラウザで新しいURL（例：`http://localhost:8080`）にアクセス

## 🚀 基本的な使い方

### 1. トップページ
- システムの概要と各機能へのリンクが表示されます
- 各ボタンをクリックして目的の機能にアクセスできます

### 2. 商品管理
- 「商品管理」をクリック
- 商品の追加、編集、削除が可能
- 商品情報（名前、価格、説明など）を入力

### 3. 注文管理  
- 「注文管理」をクリック
- 注文一覧の確認
- 注文ステータスの更新

### 4. AI対話機能
- 「AI対話」をクリック
- チャット形式でAIと会話
- 商品や注文に関する質問が可能

### 5. 音声入力機能
- AI対話画面でマイクボタンをクリック
- ブラウザがマイクの使用許可を求めたら「許可」をクリック
- 話しかけると自動で音声がテキストに変換されます
- 日本語での音声入力に対応
- ※OpenAI APIキーの設定が必要です

### 6. 画像認識機能
- AI対話画面で画像アップロードボタンをクリック
- 写真ファイルを選択してアップロード
- 画像の内容についてAIに質問できます
- 商品写真の分析や説明文作成に便利
- ※OpenAI APIキーの設定が必要です

### 7. テストデータ自動導入
- 初回起動時に自動でサンプルの商品・注文データが作成されます
- すぐにシステムの動作を確認できます
- データが不要な場合は削除可能

### 8. データ表示・管理機能
- 「テーブル照会」をクリック
- 商品、注文、注文アイテムを表形式で表示
- データの編集、削除が可能
- 「データクリア・再導入」でテストデータをリセット可能

## 🔧 トラブルシューティング

### プログラムが起動しない場合

**症状**: ダブルクリックしても何も起こらない
**解決方法**:
1. ウイルス対策ソフトがブロックしていないか確認
2. 管理者権限で実行してみる
3. Windowsの場合、Windows Defenderの除外設定に追加

### ブラウザでアクセスできない場合

**症状**: `http://localhost:8000` にアクセスできない
**解決方法**:
1. プログラムが正常に起動しているか確認
2. ファイアウォールがポート8000をブロックしていないか確認
3. 別のブラウザで試してみる
4. `http://127.0.0.1:8000` でアクセスしてみる

### AI機能が動作しない場合

**症状**: AI対話で応答がない、エラーが表示される
**解決方法**:
1. 設定ページでAPIキーが正しく入力されているか確認
2. インターネット接続を確認
3. APIキーの有効期限や使用制限を確認
4. 設定なしでも基本的なAI機能（ローカルモデル）は使用可能

### ポート番号の競合

**症状**: 「ポートが既に使用されています」エラー
**解決方法**:
1. 他のプログラムでポート8000を使用していないか確認
2. 設定ページでポート番号を変更（例：8080、8888など）
3. プログラムを再起動

### 音声入力が動作しない場合

**症状**: マイクボタンを押しても音声が認識されない
**解決方法**:
1. ブラウザでマイクの使用許可が与えられているか確認
2. OpenAI APIキーが正しく設定されているか確認
3. マイクがパソコンに正しく接続されているか確認
4. 他のアプリケーションがマイクを使用していないか確認
5. ブラウザを再起動してみる

### 画像認識が動作しない場合

**症状**: 画像をアップロードしてもエラーが表示される
**解決方法**:
1. OpenAI APIキーが正しく設定されているか確認
2. 画像ファイルのサイズが大きすぎないか確認（推奨：5MB以下）
3. サポートされている画像形式か確認（JPG、PNG、GIF、WebP）
4. インターネット接続を確認

## 📊 データの保存場所

- **データベース**: `app.db` - 商品・注文データが保存
- **設定ファイル**: `.env` - システム設定が保存
- **テストデータ**: `test/csv_data/` フォルダ - 自動生成されるサンプルデータ
- **ログファイル**: プログラムと同じフォルダに生成

## 🔒 セキュリティについて

- このプログラムはローカル環境（あなたのパソコン内）でのみ動作
- インターネット経由でのアクセスは不可
- APIキーは暗号化されずに保存されるため、パソコンの管理に注意

## 🆘 サポート

### よくある質問

**Q: 複数のパソコンで使用できますか？**
A: はい。各パソコンにプログラムをコピーして使用できます。ただし、データは共有されません。

**Q: データのバックアップは必要ですか？**
A: 重要なデータがある場合は、`app.db`を定期的にバックアップすることをお勧めします。

**Q: プログラムのアップデートはどうすればよいですか？**
A: 新しいバージョンが配布された場合、古いプログラムを削除して新しいものに置き換えてください。`app.db`と`.env`ファイルは保持してください。

**Q: 他の人と共有して使用できますか？**
A: 同じネットワーク内であれば可能ですが、セキュリティ上の理由から推奨しません。

**Q: 音声入力機能はオフラインで使用できますか？**
A: いいえ。音声入力機能はOpenAI Whisper APIを使用するため、インターネット接続とAPIキーが必要です。

**Q: 画像認識機能はどのような画像に対応していますか？**
A: JPG、PNG、GIF、WebP形式の画像に対応しています。商品写真、図表、文書などの分析が可能です。

**Q: テストデータを削除したい場合はどうすればよいですか？**
A: テーブル照会画面で個別に削除するか、「データクリア・再導入」機能で一括リセットできます。

**Q: 音声入力で認識される言語は何ですか？**
A: 主に日本語に対応していますが、他の言語でも認識可能です。

### 問題が解決しない場合

1. プログラムを完全に終了
2. パソコンを再起動
3. プログラムを再度起動
4. それでも解決しない場合は、配布元にお問い合わせください

## 📝 更新履歴

- **v1.0.0**: 初回リリース
  - 基本的な商品・注文管理機能
  - AI対話機能
  - 設定管理機能
  - 音声入力機能（OpenAI Whisper API使用）
  - 画像認識入力機能（OpenAI Vision API使用）
  - 初回起動時テストデータ自動導入機能
  - データ表示・管理機能（表形式でのデータ確認・編集）

---

**注意**: このソフトウェアを使用する際は、APIキーの管理に十分注意し、第三者に漏洩しないよう気をつけてください。
